# Prometheus 설정 파일
# AI Drawing Analysis System 모니터링

global:
  scrape_interval: 15s  # 15초마다 메트릭 수집
  evaluation_interval: 15s  # 15초마다 규칙 평가
  external_labels:
    cluster: 'drawing-analysis'
    environment: 'production'

# Alertmanager 설정 (선택사항)
# alerting:
#   alertmanagers:
#     - static_configs:
#         - targets:
#           - alertmanager:9093

# 알림 규칙 파일
rule_files:
  - 'alerts.yml'

# 메트릭 수집 대상
scrape_configs:
  # Prometheus 자체 모니터링
  - job_name: 'prometheus'
    static_configs:
      - targets: ['localhost:9090']

  # Gateway API
  - job_name: 'gateway'
    static_configs:
      - targets: ['gateway:8000']
    metrics_path: '/metrics'
    scrape_interval: 10s
    scrape_timeout: 5s

  # eDOCr2 API
  - job_name: 'edocr2'
    static_configs:
      - targets: ['edocr2:8001']
    metrics_path: '/metrics'
    scrape_interval: 10s

  # YOLO API
  - job_name: 'yolo'
    static_configs:
      - targets: ['yolo:8002']
    metrics_path: '/metrics'
    scrape_interval: 10s

  # EDGNet API
  - job_name: 'edgnet'
    static_configs:
      - targets: ['edgnet:8003']
    metrics_path: '/metrics'
    scrape_interval: 10s

  # Skin Model API
  - job_name: 'skinmodel'
    static_configs:
      - targets: ['skinmodel:8004']
    metrics_path: '/metrics'
    scrape_interval: 10s

  # VL API
  - job_name: 'vl'
    static_configs:
      - targets: ['vl:8005']
    metrics_path: '/metrics'
    scrape_interval: 10s

  # PaddleOCR API
  - job_name: 'paddleocr'
    static_configs:
      - targets: ['paddleocr:8006']
    metrics_path: '/metrics'
    scrape_interval: 10s

  # Admin Dashboard
  - job_name: 'admin-dashboard'
    static_configs:
      - targets: ['admin-dashboard:8007']
    metrics_path: '/metrics'
    scrape_interval: 10s

  # Node Exporter (시스템 메트릭 - 설치 필요)
  # - job_name: 'node'
  #   static_configs:
  #     - targets: ['node-exporter:9100']
  #   scrape_interval: 15s

  # cAdvisor (Docker 컨테이너 메트릭 - 설치 필요)
  # - job_name: 'cadvisor'
  #   static_configs:
  #     - targets: ['cadvisor:8080']
  #   scrape_interval: 15s

  # NVIDIA GPU 메트릭 (nvidia-dcgm-exporter 설치 필요)
  # - job_name: 'gpu'
  #   static_configs:
  #     - targets: ['dcgm-exporter:9400']
  #   scrape_interval: 10s
