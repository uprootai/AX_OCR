{
  "dashboard": {
    "title": "AI Drawing Analysis - Technical Dashboard",
    "tags": ["ai", "technical", "performance", "detailed"],
    "timezone": "browser",
    "schemaVersion": 38,
    "version": 1,
    "refresh": "10s",
    "time": {
      "from": "now-1h",
      "to": "now"
    },
    "panels": [
      {
        "id": 1,
        "title": "Request Latency Heatmap",
        "type": "heatmap",
        "gridPos": { "h": 10, "w": 24, "x": 0, "y": 0 },
        "targets": [
          {
            "expr": "rate(http_request_duration_seconds_bucket[5m])",
            "format": "heatmap",
            "legendFormat": "{{le}}",
            "refId": "A"
          }
        ],
        "options": {
          "calculate": true,
          "yAxis": {
            "format": "s",
            "decimals": 2
          },
          "cellGap": 2,
          "color": {
            "mode": "spectrum",
            "scheme": "Spectral"
          }
        }
      },
      {
        "id": 2,
        "title": "API Throughput by Endpoint",
        "type": "bargauge",
        "gridPos": { "h": 8, "w": 12, "x": 0, "y": 10 },
        "targets": [
          {
            "expr": "sum by (job, endpoint) (rate(http_requests_total[5m]))",
            "legendFormat": "{{job}}/{{endpoint}}",
            "refId": "A"
          }
        ],
        "options": {
          "orientation": "horizontal",
          "displayMode": "gradient",
          "showUnfilled": true
        },
        "fieldConfig": {
          "defaults": {
            "unit": "reqps",
            "min": 0,
            "thresholds": {
              "mode": "absolute",
              "steps": [
                { "value": 0, "color": "green" },
                { "value": 10, "color": "yellow" },
                { "value": 50, "color": "red" }
              ]
            }
          }
        }
      },
      {
        "id": 3,
        "title": "Response Status Codes Distribution",
        "type": "timeseries",
        "gridPos": { "h": 8, "w": 12, "x": 12, "y": 10 },
        "targets": [
          {
            "expr": "sum by (status) (rate(http_requests_total[5m]))",
            "legendFormat": "{{status}}",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "custom": {
              "drawStyle": "bars",
              "fillOpacity": 80,
              "stacking": {
                "mode": "normal"
              }
            }
          },
          "overrides": [
            {
              "matcher": { "id": "byRegexp", "options": "2.." },
              "properties": [{ "id": "color", "value": { "mode": "fixed", "fixedColor": "green" } }]
            },
            {
              "matcher": { "id": "byRegexp", "options": "4.." },
              "properties": [{ "id": "color", "value": { "mode": "fixed", "fixedColor": "yellow" } }]
            },
            {
              "matcher": { "id": "byRegexp", "options": "5.." },
              "properties": [{ "id": "color", "value": { "mode": "fixed", "fixedColor": "red" } }]
            }
          ]
        }
      },
      {
        "id": 4,
        "title": "Model Inference Performance",
        "type": "graph",
        "gridPos": { "h": 8, "w": 12, "x": 0, "y": 18 },
        "targets": [
          {
            "expr": "histogram_quantile(0.50, rate(inference_duration_seconds_bucket{job=~\"edocr2|yolo|edgnet|skinmodel\"}[5m]))",
            "legendFormat": "{{job}} - P50",
            "refId": "A"
          },
          {
            "expr": "histogram_quantile(0.95, rate(inference_duration_seconds_bucket{job=~\"edocr2|yolo|edgnet|skinmodel\"}[5m]))",
            "legendFormat": "{{job}} - P95",
            "refId": "B"
          },
          {
            "expr": "histogram_quantile(0.99, rate(inference_duration_seconds_bucket{job=~\"edocr2|yolo|edgnet|skinmodel\"}[5m]))",
            "legendFormat": "{{job}} - P99",
            "refId": "C"
          }
        ],
        "yaxes": [
          { "format": "s", "label": "Inference Time" },
          { "format": "short" }
        ],
        "lines": true,
        "fill": 0,
        "linewidth": 2,
        "legend": {
          "show": true,
          "alignAsTable": true,
          "avg": true,
          "current": true,
          "max": true
        }
      },
      {
        "id": 5,
        "title": "Model Accuracy Metrics",
        "type": "timeseries",
        "gridPos": { "h": 8, "w": 12, "x": 12, "y": 18 },
        "targets": [
          {
            "expr": "model_accuracy{job=~\"edocr2|yolo|edgnet|skinmodel\"}",
            "legendFormat": "{{job}} - Accuracy",
            "refId": "A"
          },
          {
            "expr": "model_precision{job=~\"edocr2|yolo|edgnet|skinmodel\"}",
            "legendFormat": "{{job}} - Precision",
            "refId": "B"
          },
          {
            "expr": "model_recall{job=~\"edocr2|yolo|edgnet|skinmodel\"}",
            "legendFormat": "{{job}} - Recall",
            "refId": "C"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "percentunit",
            "min": 0,
            "max": 1,
            "custom": {
              "fillOpacity": 10
            }
          }
        }
      },
      {
        "id": 6,
        "title": "GPU Utilization",
        "type": "timeseries",
        "gridPos": { "h": 8, "w": 12, "x": 0, "y": 26 },
        "targets": [
          {
            "expr": "dcgm_gpu_utilization",
            "legendFormat": "GPU {{gpu}} - Utilization",
            "refId": "A"
          },
          {
            "expr": "dcgm_sm_clock",
            "legendFormat": "GPU {{gpu}} - SM Clock",
            "refId": "B"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "percent"
          },
          "overrides": [
            {
              "matcher": { "id": "byRegexp", "options": ".*Clock.*" },
              "properties": [{ "id": "unit", "value": "hertz" }]
            }
          ]
        }
      },
      {
        "id": 7,
        "title": "GPU Power Consumption",
        "type": "timeseries",
        "gridPos": { "h": 8, "w": 12, "x": 12, "y": 26 },
        "targets": [
          {
            "expr": "dcgm_power_usage",
            "legendFormat": "GPU {{gpu}} - Power",
            "refId": "A"
          },
          {
            "expr": "dcgm_power_limit",
            "legendFormat": "GPU {{gpu}} - Power Limit",
            "refId": "B"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "watt",
            "custom": {
              "fillOpacity": 10
            }
          }
        }
      },
      {
        "id": 8,
        "title": "Training Progress",
        "type": "timeseries",
        "gridPos": { "h": 8, "w": 12, "x": 0, "y": 34 },
        "targets": [
          {
            "expr": "training_job_progress",
            "legendFormat": "{{job_id}} - Progress",
            "refId": "A"
          },
          {
            "expr": "training_job_epoch / training_job_total_epochs * 100",
            "legendFormat": "{{job_id}} - Epoch Progress",
            "refId": "B"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "percent",
            "min": 0,
            "max": 100
          }
        }
      },
      {
        "id": 9,
        "title": "Training Loss & Accuracy",
        "type": "timeseries",
        "gridPos": { "h": 8, "w": 12, "x": 12, "y": 34 },
        "targets": [
          {
            "expr": "training_loss",
            "legendFormat": "{{job_id}} - Loss",
            "refId": "A"
          },
          {
            "expr": "training_accuracy",
            "legendFormat": "{{job_id}} - Accuracy",
            "refId": "B"
          },
          {
            "expr": "validation_accuracy",
            "legendFormat": "{{job_id}} - Val Accuracy",
            "refId": "C"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "custom": {
              "fillOpacity": 10
            }
          },
          "overrides": [
            {
              "matcher": { "id": "byRegexp", "options": ".*Loss.*" },
              "properties": [{ "id": "custom.axisPlacement", "value": "right" }]
            }
          ]
        }
      },
      {
        "id": 10,
        "title": "Network I/O",
        "type": "timeseries",
        "gridPos": { "h": 8, "w": 12, "x": 0, "y": 42 },
        "targets": [
          {
            "expr": "rate(node_network_receive_bytes_total[5m])",
            "legendFormat": "RX - {{device}}",
            "refId": "A"
          },
          {
            "expr": "rate(node_network_transmit_bytes_total[5m])",
            "legendFormat": "TX - {{device}}",
            "refId": "B"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "Bps",
            "custom": {
              "fillOpacity": 20
            }
          }
        }
      },
      {
        "id": 11,
        "title": "Disk I/O",
        "type": "timeseries",
        "gridPos": { "h": 8, "w": 12, "x": 12, "y": 42 },
        "targets": [
          {
            "expr": "rate(node_disk_read_bytes_total[5m])",
            "legendFormat": "Read - {{device}}",
            "refId": "A"
          },
          {
            "expr": "rate(node_disk_written_bytes_total[5m])",
            "legendFormat": "Write - {{device}}",
            "refId": "B"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "Bps",
            "custom": {
              "fillOpacity": 20
            }
          }
        }
      },
      {
        "id": 12,
        "title": "Docker Container Stats",
        "type": "table",
        "gridPos": { "h": 8, "w": 24, "x": 0, "y": 50 },
        "targets": [
          {
            "expr": "container_memory_usage_bytes / container_spec_memory_limit_bytes * 100",
            "format": "table",
            "instant": true,
            "refId": "A"
          }
        ],
        "transformations": [
          {
            "id": "organize",
            "options": {
              "excludeByName": {},
              "indexByName": {},
              "renameByName": {
                "container": "Container",
                "Value": "Memory Usage %"
              }
            }
          }
        ],
        "options": {
          "showHeader": true,
          "sortBy": [
            {
              "displayName": "Memory Usage %",
              "desc": true
            }
          ]
        }
      },
      {
        "id": 13,
        "title": "API Request Queue Length",
        "type": "timeseries",
        "gridPos": { "h": 8, "w": 12, "x": 0, "y": 58 },
        "targets": [
          {
            "expr": "http_request_queue_length",
            "legendFormat": "{{job}} - Queue",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "short",
            "custom": {
              "fillOpacity": 20
            }
          }
        }
      },
      {
        "id": 14,
        "title": "Cache Hit Rate",
        "type": "timeseries",
        "gridPos": { "h": 8, "w": 12, "x": 12, "y": 58 },
        "targets": [
          {
            "expr": "rate(cache_hits_total[5m]) / (rate(cache_hits_total[5m]) + rate(cache_misses_total[5m])) * 100",
            "legendFormat": "{{job}} - Hit Rate",
            "refId": "A"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "percent",
            "min": 0,
            "max": 100
          }
        }
      }
    ]
  },
  "overwrite": true
}
