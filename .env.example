# AX Microservice API System - Environment Configuration
# Copy this file to .env and customize the values

# ============================================================================
# Vision Language Model API Keys (VL API 필수)
# ============================================================================

# Anthropic Claude API Key
# Get your key from: https://console.anthropic.com/
ANTHROPIC_API_KEY=your_anthropic_api_key_here

# OpenAI API Key (for GPT-4V)
# Get your key from: https://platform.openai.com/api-keys
OPENAI_API_KEY=your_openai_api_key_here

# ============================================================================
# Service Ports
# ============================================================================
EDOCR2_PORT=5001
EDOCR2_V2_PORT=5002
EDGNET_PORT=5012
SKINMODEL_PORT=5003
VL_API_PORT=5004
YOLO_API_PORT=5005
PADDLEOCR_PORT=5006
GATEWAY_PORT=8000
WEB_UI_PORT=5173

# ============================================================================
# Security Configuration (Optional)
# ============================================================================

# API Authentication (Optional)
# Set to 'true' to enable API key authentication
ENABLE_AUTH=false

# API Key for authentication
# Generate a strong random key: openssl rand -hex 32
API_KEY=your-secret-api-key-here

# Path to security config YAML (optional, overrides API_KEY if provided)
# SECURITY_CONFIG=/path/to/security_config.yaml

# ============================================================================
# Rate Limiting Configuration (Optional)
# ============================================================================

# Enable rate limiting (Optional)
# Set to 'true' to prevent abuse and DoS attacks
ENABLE_RATE_LIMIT=false

# Rate limits per IP address
RATE_LIMIT_PER_MINUTE=30
RATE_LIMIT_PER_HOUR=500
RATE_LIMIT_PER_DAY=3000

# ============================================================================
# Service URLs (Internal - Docker network)
# ============================================================================

# These are used for inter-service communication within Docker
EDOCR2_V1_URL=http://edocr2-api:5001
EDOCR2_V2_URL=http://edocr2-v2-api:5002
EDGNET_URL=http://edgnet-api:5002
SKINMODEL_URL=http://skinmodel-api:5003
VL_API_URL=http://vl-api:5004
YOLO_API_URL=http://yolo-api:5005
PADDLEOCR_URL=http://paddleocr-api:5006

# ============================================================================
# Circuit Breaker Configuration (Advanced)
# ============================================================================

# Number of consecutive failures before opening circuit
CIRCUIT_BREAKER_FAILURE_THRESHOLD=5

# Time in seconds before attempting to close circuit
CIRCUIT_BREAKER_TIMEOUT=60

# ============================================================================
# Retry Configuration (Advanced)
# ============================================================================

# Maximum retry attempts for failed requests
RETRY_MAX_ATTEMPTS=3

# Initial delay in seconds before first retry
RETRY_INITIAL_DELAY=1.0

# Maximum delay in seconds between retries
RETRY_MAX_DELAY=10.0

# Exponential backoff base
RETRY_EXPONENTIAL_BASE=2.0

# ============================================================================
# Logging Configuration
# ============================================================================

# Log level: debug, info, warning, error, critical
GATEWAY_LOG_LEVEL=info
EDOCR2_LOG_LEVEL=info
EDGNET_LOG_LEVEL=info
SKINMODEL_LOG_LEVEL=info
VL_API_LOG_LEVEL=info
YOLO_LOG_LEVEL=info
PADDLEOCR_LOG_LEVEL=info

# ============================================================================
# Performance Configuration
# ============================================================================

# Number of worker processes per service
GATEWAY_WORKERS=4
EDOCR2_WORKERS=2
EDGNET_WORKERS=2
SKINMODEL_WORKERS=2
VL_API_WORKERS=2
YOLO_WORKERS=1
PADDLEOCR_WORKERS=1

# Request timeout in seconds
REQUEST_TIMEOUT=120

# ============================================================================
# CORS Configuration
# ============================================================================

# Allowed origins for CORS (comma-separated)
CORS_ORIGINS=http://localhost:5173,http://localhost:3000

# ============================================================================
# GPU Configuration
# ============================================================================

# Enable GPU usage for YOLO, EDGNet, eDOCr2, PaddleOCR
USE_GPU=true

# CUDA device ID (0, 1, 2, etc.)
CUDA_DEVICE=0

# ============================================================================
# Usage Examples
# ============================================================================

# Development (minimal setup):
#   ANTHROPIC_API_KEY=sk-ant-...
#   OPENAI_API_KEY=sk-...
#   ENABLE_AUTH=false
#   ENABLE_RATE_LIMIT=false
#   USE_GPU=true

# Production (with security):
#   ANTHROPIC_API_KEY=sk-ant-...
#   OPENAI_API_KEY=sk-...
#   ENABLE_AUTH=true
#   API_KEY=<strong-random-key>
#   ENABLE_RATE_LIMIT=true
#   RATE_LIMIT_PER_MINUTE=30
#   RATE_LIMIT_PER_HOUR=500

# Testing (permissive rate limits):
#   ENABLE_RATE_LIMIT=true
#   RATE_LIMIT_PER_MINUTE=100
#   RATE_LIMIT_PER_HOUR=5000
