# Dimension Parser API Specification
# Gateway ë‚´ë¶€ ì²˜ë¦¬ (ë³„ë„ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì—†ìŒ)
# eDOCr2 ì¶œë ¥ í›„ì²˜ë¦¬ - ë² ì–´ë§ ì¹˜ìˆ˜ êµ¬ì¡°í™” íŒŒì‹±

apiVersion: v1
kind: APISpec

metadata:
  id: dimensionparser
  name: Dimension Parser
  version: 1.0.0
  port: 8000  # Gateway ë‚´ë¶€ ì²˜ë¦¬
  host: gateway-api
  description: ë² ì–´ë§ ë„ë©´ ì¹˜ìˆ˜ë¥¼ êµ¬ì¡°í™”ëœ í˜•íƒœë¡œ íŒŒì‹± (OD/ID/Length, ê³µì°¨, GD&T)
  author: AX Team
  tags:
    - analysis
    - dimension
    - bearing
    - tolerance

server:
  endpoint: /api/v1/dimension/parse
  method: POST
  contentType: application/json
  timeout: 30
  healthEndpoint: /health

blueprintflow:
  category: analysis
  color: "#f59e0b"
  icon: Ruler
  requiresImage: false

inputs:
  - name: text_results
    type: TextResult[]
    required: false
    description: eDOCr2 OCR ê²°ê³¼ (í…ìŠ¤íŠ¸ + bbox)
  - name: dimensions
    type: string[]
    required: false
    description: ì¹˜ìˆ˜ í…ìŠ¤íŠ¸ ëª©ë¡ (ì§ì ‘ ì…ë ¥)
  - name: image
    type: Image
    required: false
    description: ë„ë©´ ì´ë¯¸ì§€ (OCR ì—†ì´ ì „ë‹¬)

outputs:
  - name: parsed_dimensions
    type: BearingDimension[]
    description: êµ¬ì¡°í™”ëœ ë² ì–´ë§ ì¹˜ìˆ˜ ëª©ë¡
  - name: bearing_specs
    type: BearingSpec
    description: ì¢…í•© ë² ì–´ë§ ì‚¬ì–‘ (OD, ID, Length ë“±)
  - name: tolerances
    type: Tolerance[]
    description: ì¶”ì¶œëœ ê³µì°¨ ëª©ë¡
  - name: gdt_symbols
    type: GDTSymbol[]
    description: ì¶”ì¶œëœ GD&T ê¸°í˜¸ ëª©ë¡
  - name: dimensions_count
    type: number
    description: íŒŒì‹±ëœ ì¹˜ìˆ˜ ê°œìˆ˜
  - name: confidence
    type: number
    description: íŒŒì‹± ì‹ ë¢°ë„ (0-1)

parameters:
  - name: dimension_type
    type: select
    options:
      - bearing
      - general
      - shaft
      - housing
    default: bearing
    description: ì¹˜ìˆ˜ ìœ í˜• (bearing=ë² ì–´ë§, general=ì¼ë°˜)

  - name: parse_tolerance
    type: boolean
    default: true
    description: ê³µì°¨ íŒŒì‹± (H7, Â±0.1 ë“±)

  - name: parse_gdt
    type: boolean
    default: true
    description: GD&T ê¸°í˜¸ íŒŒì‹± (âŒ€, âŠ¥, // ë“±)

  - name: extract_od_id
    type: boolean
    default: true
    description: OD/ID ìë™ ë¶„ë¥˜ (ë² ì–´ë§ ì „ìš©)

  - name: unit
    type: select
    options:
      - mm
      - inch
      - auto
    default: mm
    description: ì¹˜ìˆ˜ ë‹¨ìœ„

i18n:
  ko:
    label: Dimension Parser
    description: ë² ì–´ë§ ì¹˜ìˆ˜ë¥¼ êµ¬ì¡°í™”ëœ í˜•íƒœë¡œ íŒŒì‹± (OD/ID, ê³µì°¨, GD&T)
  en:
    label: Dimension Parser
    description: Parse bearing dimensions into structured format (OD/ID, tolerance, GD&T)

profiles:
  default: bearing
  available:
    - name: bearing
      label: "ë² ì–´ë§ ì¹˜ìˆ˜"
      description: "DSE Bearing ë„ë©´ ì¹˜ìˆ˜ ìµœì í™”"
      params:
        dimension_type: bearing
        parse_tolerance: true
        parse_gdt: true
        extract_od_id: true
        unit: mm

    - name: general
      label: "ì¼ë°˜ ì¹˜ìˆ˜"
      description: "ë²”ìš© ì¹˜ìˆ˜ íŒŒì‹±"
      params:
        dimension_type: general
        parse_tolerance: true
        parse_gdt: true
        extract_od_id: false
        unit: mm

    - name: precision
      label: "ì •ë°€ ì¹˜ìˆ˜"
      description: "ì •ë°€ ê³µì°¨ ì¤‘ì‹¬ íŒŒì‹±"
      params:
        dimension_type: general
        parse_tolerance: true
        parse_gdt: true
        extract_od_id: false
        unit: mm

examples:
  - "eDOCr2 â†’ Dimension Parser â†’ êµ¬ì¡°í™”ëœ ë² ì–´ë§ ì¹˜ìˆ˜"
  - "OD670Ã—ID440 â†’ {outer_diameter: 670, inner_diameter: 440}"
  - "Ã˜25H7 â†’ {diameter: 25, tolerance: 'H7'}"

usageTips:
  - "â­ eDOCr2 ì¶œë ¥ì„ ì…ë ¥ìœ¼ë¡œ ì—°ê²°í•˜ë©´ ìë™ìœ¼ë¡œ ì¹˜ìˆ˜ íŒŒì‹±"
  - "ğŸ’¡ extract_od_id=trueë¡œ ì™¸ê²½/ë‚´ê²½ ìë™ ë¶„ë¥˜"
  - "ğŸ“ GD&T ê¸°í˜¸ (âŒ€, âŠ¥, //) ìë™ ì¸ì‹"
  - "ğŸ”— SkinModelê³¼ ì—°ê²°í•˜ì—¬ ê³µì°¨ ë¶„ì„ ê°€ëŠ¥"

recommendedInputs:
  - from: edocr2
    field: text_results
    reason: "â­ eDOCr2 ì¹˜ìˆ˜ ì¸ì‹ ê²°ê³¼ë¥¼ êµ¬ì¡°í™”"
  - from: paddleocr
    field: text_results
    reason: "PaddleOCR ê²°ê³¼ë„ í™œìš© ê°€ëŠ¥"

resources:
  gpu:
    vram: "0"
    recommended: "CPUë¡œ ì¶©ë¶„ (ì •ê·œì‹ íŒŒì‹±)"
  cpu:
    ram: "~512MB"
    minRam: 256
    cores: 1
    note: "ê²½ëŸ‰ íŒŒì‹± ì‘ì—…"

openapi:
  requestExamples:
    - name: "ë² ì–´ë§ ì¹˜ìˆ˜ íŒŒì‹±"
      description: "ë² ì–´ë§ ë„ë©´ ì¹˜ìˆ˜ êµ¬ì¡°í™”"
      jsonBody:
        dimensions: ["OD670Ã—ID440", "Ã˜25H7", "50.0Â±0.1", "1100Ã—ID680Ã—200L"]
        dimension_type: "bearing"

  responseExamples:
    - name: "ì„±ê³µ ì‘ë‹µ"
      statusCode: 200
      response:
        success: true
        parsed_dimensions:
          - raw_text: "OD670Ã—ID440"
            outer_diameter: 670
            inner_diameter: 440
            type: "bearing"
          - raw_text: "Ã˜25H7"
            diameter: 25
            tolerance: "H7"
            type: "diameter"
        bearing_specs:
          outer_diameter: 670
          inner_diameter: 440
          length: 200
        tolerances:
          - value: "H7"
            type: "fit"
          - value: "Â±0.1"
            type: "dimensional"
        dimensions_count: 4
        confidence: 0.92
        processing_time_ms: 45
