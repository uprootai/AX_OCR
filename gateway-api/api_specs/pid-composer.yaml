# PID Composer API Specification
# P&ID ë„ë©´ ë ˆì´ì–´ í•©ì„± ë° ì‹œê°í™”

api_id: pid_composer
display_name: "PID Composer"
version: "1.0.0"
category: analysis
description: "P&ID ë„ë©´ì— ì‹¬ë³¼, ë¼ì¸, í…ìŠ¤íŠ¸, ì˜ì—­ ë ˆì´ì–´ë¥¼ í•©ì„±í•˜ì—¬ ì‹œê°í™”í•©ë‹ˆë‹¤. ì„œë²„ ì‚¬ì´ë“œ ì´ë¯¸ì§€ ë Œë”ë§ ë° í´ë¼ì´ì–¸íŠ¸ìš© SVG ì˜¤ë²„ë ˆì´ ìƒì„±ì„ ì§€ì›í•©ë‹ˆë‹¤."
description_en: "Compose symbol, line, text, and region layers onto P&ID diagrams for visualization. Supports server-side image rendering and client-side SVG overlay generation."

# Service Configuration
service:
  port: 5021
  base_url: "http://pid-composer-api:5021"
  health_endpoint: "/health"
  container_name: "pid-composer-api"

# BlueprintFlow Node Configuration
blueprintflow:
  node_type: "pidcomposer"
  icon: "ğŸ¨"
  color: "#8b5cf6"  # Purple

  inputs:
    - name: image
      type: image
      required: true
      description: "ì›ë³¸ P&ID ì´ë¯¸ì§€"
    - name: symbols
      type: array
      required: false
      description: "ì‹¬ë³¼ ë ˆì´ì–´ ë°ì´í„°"
    - name: lines
      type: array
      required: false
      description: "ë¼ì¸ ë ˆì´ì–´ ë°ì´í„°"
    - name: texts
      type: array
      required: false
      description: "í…ìŠ¤íŠ¸ ë ˆì´ì–´ ë°ì´í„°"
    - name: regions
      type: array
      required: false
      description: "ì˜ì—­ ë ˆì´ì–´ ë°ì´í„°"

  outputs:
    - name: composed_image
      type: image
      description: "í•©ì„±ëœ ì´ë¯¸ì§€"
    - name: svg_overlay
      type: string
      description: "SVG ì˜¤ë²„ë ˆì´ (í”„ë¡ íŠ¸ì—”ë“œìš©)"
    - name: statistics
      type: object
      description: "í•©ì„± í†µê³„"

  parameters:
    # Layer Control
    - name: enabled_layers
      type: multiselect
      default: ["symbols", "lines", "texts", "regions"]
      options: ["symbols", "lines", "texts", "regions"]
      description: "í™œì„±í™”í•  ë ˆì´ì–´"
      description_en: "Layers to enable"

    # Output Options
    - name: output_format
      type: select
      default: "png"
      options: ["png", "jpg", "webp"]
      description: "ì¶œë ¥ ì´ë¯¸ì§€ í˜•ì‹"
      description_en: "Output image format"

    - name: include_svg
      type: boolean
      default: true
      description: "SVG ì˜¤ë²„ë ˆì´ í¬í•¨"
      description_en: "Include SVG overlay"

    - name: include_legend
      type: boolean
      default: false
      description: "ë²”ë¡€ í¬í•¨"
      description_en: "Include legend"

    # Symbol Style
    - name: symbol_color
      type: color
      default: "#FF7800"
      description: "ì‹¬ë³¼ ìƒ‰ìƒ"
      description_en: "Symbol color"

    - name: symbol_thickness
      type: slider
      default: 2
      min: 1
      max: 10
      step: 1
      description: "ì‹¬ë³¼ í…Œë‘ë¦¬ ë‘ê»˜"
      description_en: "Symbol border thickness"

    - name: symbol_fill_alpha
      type: slider
      default: 0.1
      min: 0
      max: 1
      step: 0.05
      description: "ì‹¬ë³¼ ì±„ìš°ê¸° íˆ¬ëª…ë„"
      description_en: "Symbol fill opacity"

    - name: show_symbol_labels
      type: boolean
      default: true
      description: "ì‹¬ë³¼ ë¼ë²¨ í‘œì‹œ"
      description_en: "Show symbol labels"

    # Line Style
    - name: line_thickness
      type: slider
      default: 2
      min: 1
      max: 10
      step: 1
      description: "ë¼ì¸ ë‘ê»˜"
      description_en: "Line thickness"

    - name: show_flow_arrows
      type: boolean
      default: false
      description: "í”Œë¡œìš° í™”ì‚´í‘œ í‘œì‹œ"
      description_en: "Show flow arrows"

    # Text Style
    - name: text_color
      type: color
      default: "#FFA500"
      description: "í…ìŠ¤íŠ¸ ìƒ‰ìƒ"
      description_en: "Text color"

    - name: show_text_values
      type: boolean
      default: true
      description: "í…ìŠ¤íŠ¸ ê°’ í‘œì‹œ"
      description_en: "Show text values"

    # Region Style
    - name: region_fill_alpha
      type: slider
      default: 0.15
      min: 0
      max: 0.5
      step: 0.05
      description: "ì˜ì—­ ì±„ìš°ê¸° íˆ¬ëª…ë„"
      description_en: "Region fill opacity"

    - name: show_region_labels
      type: boolean
      default: true
      description: "ì˜ì—­ ë¼ë²¨ í‘œì‹œ"
      description_en: "Show region labels"

# API Endpoints
endpoints:
  - method: POST
    path: "/api/v1/compose"
    description: "ì´ë¯¸ì§€ì— ë ˆì´ì–´ í•©ì„±"
    request_content_type: "application/json"
    response_content_type: "application/json"

  - method: POST
    path: "/api/v1/compose/svg"
    description: "SVG ì˜¤ë²„ë ˆì´ë§Œ ìƒì„±"
    request_content_type: "application/json"
    response_content_type: "application/json"

  - method: POST
    path: "/api/v1/compose/layers"
    description: "ë¹ˆ ìº”ë²„ìŠ¤ì— ë ˆì´ì–´ í•©ì„±"
    request_content_type: "application/json"
    response_content_type: "application/json"

  - method: POST
    path: "/api/v1/preview"
    description: "ìŠ¤íƒ€ì¼ ë¯¸ë¦¬ë³´ê¸°"
    request_content_type: "application/json"
    response_content_type: "application/json"

  - method: GET
    path: "/api/v1/info"
    description: "ì„œë¹„ìŠ¤ ì •ë³´ ì¡°íšŒ"

# Resource Requirements
resources:
  gpu:
    required: false
    vram: "N/A"
    note: "CPU ì „ìš© ì„œë¹„ìŠ¤"
  cpu:
    ram: "~500MB"
    minRam: 256
    cores: 1
    note: "ê²½ëŸ‰ ì„œë¹„ìŠ¤, OpenCVë§Œ ì‚¬ìš©"

# Tags
tags:
  - visualization
  - overlay
  - composition
  - svg
  - pid

# Example Usage
examples:
  - name: "ì‹¬ë³¼ ì˜¤ë²„ë ˆì´"
    description: "YOLO ê²€ì¶œ ê²°ê³¼ë¥¼ ì›ë³¸ ì´ë¯¸ì§€ì— ì˜¤ë²„ë ˆì´"
    request:
      image_base64: "<base64_encoded_image>"
      layers:
        symbols:
          - bbox: {x: 100, y: 100, width: 50, height: 40}
            class_name: "Valve"
            confidence: 0.95
      enabled_layers: ["symbols"]
      include_svg: true

  - name: "ì „ì²´ ë ˆì´ì–´ í•©ì„±"
    description: "ì‹¬ë³¼, ë¼ì¸, í…ìŠ¤íŠ¸, ì˜ì—­ ëª¨ë‘ í•©ì„±"
    request:
      image_base64: "<base64_encoded_image>"
      layers:
        symbols: []
        lines: []
        texts: []
        regions: []
      enabled_layers: ["symbols", "lines", "texts", "regions"]
      include_legend: true
