# Quote Generator API Specification
# Gateway ë‚´ë¶€ ì²˜ë¦¬ (ë³„ë„ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì—†ìŒ)
# BOM â†’ ìë™ ê²¬ì  ìƒì„±

apiVersion: v1
kind: APISpec

metadata:
  id: quotegenerator
  name: Quote Generator
  version: 1.0.0
  port: 8000  # Gateway ë‚´ë¶€ ì²˜ë¦¬
  host: gateway-api
  description: BOM ê¸°ë°˜ ìë™ ê²¬ì  ìƒì„± (ì¬ë£Œë¹„, ê°€ê³µë¹„, ë§ˆì§„ ê³„ì‚°)
  author: AX Team
  tags:
    - analysis
    - quote
    - bearing
    - cost

server:
  endpoint: /api/v1/quote/generate
  method: POST
  contentType: application/json
  timeout: 60
  healthEndpoint: /health

blueprintflow:
  category: analysis
  color: "#dc2626"
  icon: Calculator
  requiresImage: false

inputs:
  - name: bom
    type: BOMEntry[]
    required: true
    description: BOM Matcher ì¶œë ¥ (ë¶€í’ˆ ëª©ë¡)
  - name: drawing_info
    type: DrawingInfo
    required: false
    description: ë„ë©´ ë©”íƒ€ ì •ë³´ (ë„ë©´ë²ˆí˜¸, í’ˆëª…)
  - name: pricing_table
    type: PricingTable
    required: false
    description: ì»¤ìŠ¤í…€ ë‹¨ê°€ í…Œì´ë¸” (ë¯¸ì…ë ¥ ì‹œ ê¸°ë³¸ê°’)

outputs:
  - name: quote
    type: QuoteDocument
    description: ê²¬ì ì„œ ë°ì´í„°
  - name: line_items
    type: QuoteLineItem[]
    description: ê²¬ì  í•­ëª© ëª©ë¡
  - name: summary
    type: QuoteSummary
    description: ê²¬ì  ìš”ì•½ (ì´ì•¡, ì„¸ê¸ˆ ë“±)
  - name: material_cost
    type: number
    description: ì¬ë£Œë¹„ í•©ê³„
  - name: labor_cost
    type: number
    description: ê°€ê³µë¹„ í•©ê³„
  - name: total_cost
    type: number
    description: ì´ ê²¬ì  ê¸ˆì•¡
  - name: quote_number
    type: string
    description: ê²¬ì  ë²ˆí˜¸

parameters:
  - name: currency
    type: select
    options:
      - KRW
      - USD
      - EUR
      - JPY
    default: KRW
    description: í†µí™” ë‹¨ìœ„

  - name: material_markup
    type: number
    min: 0
    max: 100
    step: 1
    default: 15
    description: ì¬ë£Œë¹„ ë§ˆì§„ìœ¨ (%)

  - name: labor_markup
    type: number
    min: 0
    max: 100
    step: 1
    default: 20
    description: ê°€ê³µë¹„ ë§ˆì§„ìœ¨ (%)

  - name: tax_rate
    type: number
    min: 0
    max: 30
    step: 0.5
    default: 10
    description: ë¶€ê°€ì„¸ìœ¨ (%)

  - name: include_tax
    type: boolean
    default: true
    description: ë¶€ê°€ì„¸ í¬í•¨ ì—¬ë¶€

  - name: quantity_discount
    type: boolean
    default: true
    description: ìˆ˜ëŸ‰ í• ì¸ ì ìš©

  - name: validity_days
    type: number
    min: 7
    max: 90
    step: 1
    default: 30
    description: ê²¬ì  ìœ íš¨ ê¸°ê°„ (ì¼)

  - name: output_format
    type: select
    options:
      - json
      - pdf
      - excel
    default: json
    description: ì¶œë ¥ í˜•ì‹

i18n:
  ko:
    label: Quote Generator
    description: BOM ê¸°ë°˜ ìë™ ê²¬ì  ìƒì„± (ì¬ë£Œë¹„, ê°€ê³µë¹„, ë§ˆì§„ ê³„ì‚°)
  en:
    label: Quote Generator
    description: Auto-generate quotes from BOM (materials, labor, markup)

profiles:
  default: bearing
  available:
    - name: bearing
      label: "ë² ì–´ë§ ê²¬ì "
      description: "DSE Bearing ê²¬ì  ìµœì í™”"
      params:
        currency: KRW
        material_markup: 15
        labor_markup: 20
        tax_rate: 10
        include_tax: true
        quantity_discount: true
        validity_days: 30
        output_format: json

    - name: standard
      label: "í‘œì¤€ ê²¬ì "
      description: "ì¼ë°˜ ê¸°ê³„ ë¶€í’ˆ ê²¬ì "
      params:
        currency: KRW
        material_markup: 10
        labor_markup: 15
        tax_rate: 10
        include_tax: true
        quantity_discount: false
        validity_days: 14
        output_format: json

    - name: export
      label: "ìˆ˜ì¶œìš© ê²¬ì "
      description: "í•´ì™¸ ìˆ˜ì¶œìš© (USD)"
      params:
        currency: USD
        material_markup: 20
        labor_markup: 25
        tax_rate: 0
        include_tax: false
        quantity_discount: true
        validity_days: 60
        output_format: json

examples:
  - "BOM Matcher â†’ Quote Generator â†’ ê²¬ì ì„œ JSON"
  - "ë„ë©´ ë¶„ì„ â†’ BOM â†’ ê²¬ì ì„œ PDF ìƒì„±"
  - "ë¶€í’ˆ 10ê°œ, ì¬ë£Œë¹„ 500ë§Œì› â†’ ê²¬ì  700ë§Œì› (ë§ˆì§„ í¬í•¨)"

usageTips:
  - "â­ BOM Matcher ì¶œë ¥ì„ ì…ë ¥ìœ¼ë¡œ ì—°ê²°"
  - "ğŸ’° material_markup/labor_markupìœ¼ë¡œ ë§ˆì§„ìœ¨ ì¡°ì •"
  - "ğŸ“Š ìˆ˜ëŸ‰ í• ì¸ì€ 10ê°œ ì´ìƒ 5%, 50ê°œ ì´ìƒ 10%"
  - "ğŸ“„ PDF/Excel ì¶œë ¥ìœ¼ë¡œ ê³ ê° ì œì¶œìš© ê²¬ì ì„œ ìƒì„±"
  - "ğŸ”§ pricing_tableë¡œ ì»¤ìŠ¤í…€ ë‹¨ê°€ ì ìš© ê°€ëŠ¥"

recommendedInputs:
  - from: bommatcher
    field: bom
    reason: "â­ BOM Matcher ì¶œë ¥ (ë¶€í’ˆ ëª©ë¡)"
  - from: bommatcher
    field: drawing_info
    reason: "ë„ë©´ ë©”íƒ€ ì •ë³´ (ë„ë©´ë²ˆí˜¸)"

resources:
  gpu:
    vram: "0"
    recommended: "CPUë¡œ ì¶©ë¶„ (ê³„ì‚° ë¡œì§)"
  cpu:
    ram: "~256MB"
    minRam: 128
    cores: 1
    note: "ê²½ëŸ‰ ê³„ì‚° ì‘ì—…"

openapi:
  requestExamples:
    - name: "ë² ì–´ë§ ê²¬ì  ìƒì„±"
      description: "BOM ê¸°ë°˜ ê²¬ì ì„œ ìƒì„±"
      jsonBody:
        bom:
          - item_no: 1
            part_no: "1"
            part_name: "UPPER THRUST PAD"
            material: "ASTM B23 GR.2"
            quantity: 8
          - item_no: 2
            part_no: "2"
            part_name: "LOWER THRUST PAD"
            material: "ASTM B23 GR.2"
            quantity: 8
        drawing_info:
          drawing_number: "BRG-2024-001"
          title: "THRUST BEARING ASSEMBLY"
        currency: "KRW"
        material_markup: 15
        labor_markup: 20

  responseExamples:
    - name: "ì„±ê³µ ì‘ë‹µ"
      statusCode: 200
      response:
        success: true
        quote:
          quote_number: "Q-2024-0122-001"
          date: "2024-01-22"
          validity_date: "2024-02-21"
          customer: ""
          drawing_number: "BRG-2024-001"
          title: "THRUST BEARING ASSEMBLY"
        line_items:
          - item_no: 1
            part_name: "UPPER THRUST PAD"
            material: "ASTM B23 GR.2"
            quantity: 8
            unit_price: 150000
            material_cost: 1200000
            labor_cost: 400000
            subtotal: 1600000
          - item_no: 2
            part_name: "LOWER THRUST PAD"
            material: "ASTM B23 GR.2"
            quantity: 8
            unit_price: 150000
            material_cost: 1200000
            labor_cost: 400000
            subtotal: 1600000
        summary:
          material_cost: 2400000
          labor_cost: 800000
          subtotal: 3200000
          markup: 640000
          tax: 384000
          total: 4224000
          currency: "KRW"
        processing_time_ms: 50
